:root{
  --bg:#ffffff;
  --text:#111111;
  --muted:#666666;
  --link:#0a66c2;
  --border:#e5e5e5;
  --surface:#f7f7f7;
}
@media (prefers-color-scheme: dark){
  :root{
    --bg:#0f1115;
    --text:#e7e7e7;
    --muted:#9aa0a6;
    --link:#7ab7ff;
    --border:#2a2d33;
    --surface:#161a20;
  }
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font:16px/1.65 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
  background:var(--bg);
  color:var(--text);
  /* Leave space for fixed header; JS sets --header-h dynamically */
  padding-top: var(--header-h, 56px);
}
.container{max-width:1600px;margin:0 auto;padding:0 20px}
.site-header{position:fixed;top:0;left:0;right:0;z-index:100;background:var(--bg);border-bottom:1px solid var(--border)}
.header-inner{display:flex;align-items:center;justify-content:space-between;height:56px}
.brand{font-weight:700;color:var(--text);text-decoration:none;font-size:18px}
.menu-toggle{display:none;border:1px solid var(--border);background:var(--bg);color:var(--text);border-radius:6px;padding:6px 10px;cursor:pointer}
.nav{display:flex;gap:16px}
.nav-link{color:var(--text);text-decoration:none;padding:8px 10px;border-radius:6px;transition:background-color .2s ease,color .2s ease}
.nav-link:hover{background:var(--surface);color:var(--text)}
.nav-link.github{color:var(--link)}
.search{position:relative;display:flex;align-items:center;gap:8px;margin:0 12px;flex:1;max-width:520px}
.search input[type="search"]{width:100%;height:32px;padding:6px 10px;border:1px solid var(--border);border-radius:8px;background:var(--bg);color:var(--text);outline:none}
.search input[type="search"]::placeholder{color:var(--muted)}
.search input[type="search"]:focus{border-color:var(--link);box-shadow:0 0 0 3px color-mix(in oklab, var(--link) 20%, transparent)}
.search-results{position:absolute;top:40px;left:0;right:0;background:var(--bg);border:1px solid var(--border);border-radius:8px;box-shadow:0 8px 24px rgba(0,0,0,.08);max-height:60vh;overflow:auto;display:none;z-index:20}
.search-results.open{display:block}
.search-item{display:block;padding:10px 12px;color:var(--text);text-decoration:none;border-bottom:1px solid var(--border)}
.search-item:last-child{border-bottom:none}
.search-item:hover{background:var(--surface)}
.search-item.active{background:color-mix(in oklab, var(--link) 12%, var(--bg));}
.search-item-title{font-weight:600}
.search-item-path{font-size:12px;color:var(--muted)}
.search-item mark{background:#fff3a3;color:inherit;padding:0 .5px;border-radius:2px}
.search-item-snippet{font-size:13px;color:var(--muted);margin-top:4px}
.layout{display:grid;gap:28px;padding:28px 0}
.layout-3{grid-template-columns:260px 1fr 260px}
.content{min-width:0}
.content img{max-width:100%;height:auto}
.content pre{background:var(--surface);padding:14px;border-radius:8px;overflow:auto;border:1px solid var(--border)}
.content code{background:var(--surface);padding:2px 4px;border-radius:4px}
#toc{position:sticky;top:calc(var(--header-h, 56px) + 20px);align-self:start;border-left:1px solid var(--border);padding-left:18px;max-height:calc(100vh - 100px);overflow:auto}
.toc-title{font-weight:600;margin-bottom:8px;color:var(--muted)}
.sidebar-col{position:sticky;top:calc(var(--header-h, 56px) + 20px);align-self:start;max-height:calc(100vh - 100px);overflow:auto;border-right:1px solid var(--border);padding-right:18px;padding-left:8px}
.sidebar{font-size:14px}
.sidebar-year{margin:10px 0 6px;color:var(--muted);font-weight:600}
.sidebar-group ul{list-style:none;margin:0;padding:0}
.sidebar a{display:block;padding:6px 8px;color:var(--text);text-decoration:none;border-radius:6px;transition:background-color .2s ease,color .2s ease}
.sidebar a:hover{background:var(--surface)}
.sidebar a.active{background:var(--surface);outline:1px solid var(--border)}
.site-footer{border-top:1px solid var(--border);padding:24px 0;color:var(--muted)}
.back-to-top{position:fixed;right:20px;bottom:24px;width:40px;height:40px;border-radius:20px;border:1px solid var(--border);background:var(--bg);color:var(--text);cursor:pointer;display:none;align-items:center;justify-content:center;box-shadow:0 2px 8px rgba(0,0,0,.08);transition:background-color .2s ease,opacity .2s ease}
.back-to-top:hover{background:var(--surface)}

/* <= 959px: single column, content first, TOC and sidebar stacked after */
@media (max-width: 959px){
  .layout{padding-left:20px;padding-right:20px}
  .layout-3{grid-template-columns:1fr}
  .content{order:0}
  #toc{order:1;border-left:none;border-top:1px solid var(--border);padding:12px 0;top:auto;max-height:none}
  .sidebar-col{order:2;border-right:none;border-bottom:1px solid var(--border);padding:12px 0;top:auto;max-height:none;padding-left:8px}
}

/* 960pxâ€“1399px: two columns (content + TOC), hide left sidebar */
@media (min-width: 960px) and (max-width: 1399px){
  /* add some side gutter so content isn't stuck to edges in half-screen */
  .layout{padding-left:35px;padding-right:35px}
  .layout-3{grid-template-columns:1fr 260px}
  .sidebar-col{display:none}
  #toc{border-left:1px solid var(--border);padding-left:18px;top:calc(var(--header-h, 56px) + 20px);max-height:calc(100vh - 100px)}
}

/* Mobile navigation */
@media (max-width: 800px){
  .header-inner{height:auto;flex-wrap:wrap;gap:10px;padding:8px 0}
  .brand{font-size:16px}
  .menu-toggle{display:inline-flex;align-items:center;justify-content:center}
  .search{order:1;width:100%;max-width:none;margin:0}
  .nav{width:100%;display:none;flex-direction:column;gap:0;padding:8px 0}
  .nav.open{display:flex}
  .nav-link{padding:10px;border-radius:8px}
}

.content h1,.content h2,.content h3,.content h4{scroll-margin-top:calc(var(--header-h, 56px) + 40px)}
.content table{border-collapse:collapse;width:100%;overflow:auto;display:block}
.content th,.content td{border:1px solid var(--border);padding:8px}
.content blockquote{border-left:4px solid var(--border);margin:0;padding:8px 12px;color:var(--muted);background:var(--surface)}

/* Post meta block */
.post-meta{display:flex;flex-wrap:wrap;gap:8px 12px;align-items:center;margin:8px 0 16px;color:var(--muted);font-size:14px;border-bottom:1px dashed var(--border);padding-bottom:8px}
.post-meta .meta-item{display:inline-flex;align-items:center;gap:6px}
.badge{display:inline-block;padding:2px 8px;border:1px solid var(--border);border-radius:999px;background:var(--surface);color:var(--text);font-size:12px}
.badge-cat{border-color:color-mix(in oklab, var(--link) 40%, var(--border)); background:color-mix(in oklab, var(--link) 10%, var(--surface))}
.badge-tag{border-color:var(--border)}

/* Collapsible TOC on small/medium screens */
@media (max-width: 959px){
  .toc-title{display:flex;align-items:center;justify-content:space-between;cursor:pointer;padding:8px 0}
  #toc.collapsed > :not(.toc-title){display:none}
}

/* Math formula styling */
.MathJax_Display{overflow-x:auto;overflow-y:hidden}
.MathJax{outline:0}
mjx-container[jax="SVG"]{direction:ltr}
mjx-container[jax="SVG"] > svg{overflow:visible;min-height:1px;min-width:1px}
mjx-container[jax="SVG"] > svg a{fill:blue;stroke:blue}
mjx-container[jax="SVG"][display="true"]{display:block;text-align:center;margin:1em 0}
mjx-container[jax="SVG"][display="true"][width="full"]{display:block;width:100%}
mjx-container[jax="SVG"][justify="left"]{text-align:left}
mjx-container[jax="SVG"][justify="right"]{text-align:right}

/* SVG styling */
.content svg{max-width:100%;height:auto;display:block;margin:1em auto}
.content figure{text-align:center;margin:1em 0}
.content figure svg{margin:0.5em auto}
.content .svg-container{text-align:center;margin:1em 0}

/* Code copy button styling */
.code-container{position:relative}
.copy-btn{
  position:absolute;
  top:8px;
  right:8px;
  background:var(--surface);
  border:1px solid var(--border);
  color:var(--text);
  padding:4px 8px;
  border-radius:4px;
  font-size:12px;
  cursor:pointer;
  opacity:0;
  transition:opacity .2s ease,background-color .2s ease;
  z-index:1;
}
.code-container:hover .copy-btn{opacity:1}
.copy-btn:hover{background:var(--border)}
.copy-btn.copied{
  background:var(--link);
  color:white;
  border-color:var(--link);
}

/* Dark mode adjustments for math and SVG */
@media (prefers-color-scheme: dark){
  mjx-container[jax="SVG"] > svg{color-scheme:dark}
  .content svg{filter:brightness(0.9)}
}

/* In-article highlight marks */
.content mark.hl{background:#fff3a3;color:inherit;padding:0 .5px;border-radius:2px}

/* Blue focus ring for boxes and interactive elements */
/* Blocks: show blue outline when hovered */
.content pre:hover,
.content table:hover,
.content img:hover,
.content blockquote:hover,
.content figure:hover,
.content .svg-container:hover{
  outline:2px solid var(--link);
  outline-offset:2px;
}

/* Links/Buttons: add blue outline on hover */
.nav-link:hover,
.sidebar a:hover,
#toc a:hover,
.copy-btn:hover,
.menu-toggle:hover,
.back-to-top:hover{
  outline:2px solid var(--link);
  outline-offset:2px;
}

/* Keyboard accessibility: stronger ring on focus-visible */
.nav-link:focus-visible,
.sidebar a:focus-visible,
#toc a:focus-visible,
.copy-btn:focus-visible,
.menu-toggle:focus-visible,
.back-to-top:focus-visible,
.content pre:focus-visible,
.content table:focus-visible,
.content img:focus-visible,
.content blockquote:focus-visible,
.content figure:focus-visible,
.content .svg-container:focus-visible{
  outline:3px solid var(--link);
  outline-offset:2px;
}
